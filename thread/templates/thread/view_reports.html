{% extends 'base.html' %}
{% load static %}
{% block title %}Report List{% endblock %}

{% block content %}
<style>
    body {
        background-color: #f8f9fa; /* Light background for contrast */
    }
    .report-container {
        display: flex;
        flex-direction: column;
        align-items: center; /* Center align */
        width: 100%; /* Full width */
        margin-top: 20px;
    }
    .table {
        background-color: #ffffff; /* White background for the table */
        border-radius: 5px; /* Rounded corners */
        overflow: hidden; /* Round corners on the table */
        width: 80%; /* Set a width for the table */
        margin-bottom: 20px; /* Spacing below the table */
    }
    .table th {
        background-color: black; /* Bootstrap primary color for header */
        color: white; /* White text for contrast */
    }
    .pagination {
        margin-top: 10px; /* Reduced space above pagination */
    }
    .search-bar {
        margin-bottom: 20px; /* Spacing below the search bar */
    }
</style>

<ul class="nav nav-tabs mb-3 justify-content-start">
    <li class="nav-item">
        <a class="nav-link" href="{% url 'thread:thread_list' %}">Thread</a>
    </li>
    <li class="nav-item">
        <a class="nav-link" href="{% url 'thread:recent_activity' %}">Recent Activity</a>
    </li>
    <li class="nav-item">
        <a class="nav-link active" href="{% url 'thread:view_reports' %}">Report</a>
    </li>
</ul>
<div class="container report-container">
    
    <h2 class="text-center mb-4">Report List</h2>
    <form method="GET" action="{% url 'thread:view_reports' %}" class="form-inline d-flex justify-content-center search-bar">
        <input type="text" name="q" class="form-control mr-sm-2" placeholder="Search reports..." value="{{ query|default:'' }}">
        <button class="btn btn-outline-success my-2 my-sm-0" type="submit">Search</button>
    </form>

    <table class="table table-striped table-hover">
        <thead class="thead-dark">
            <tr>
                <th>ID</th>
                <th>Thread Title</th>
                <th>Reported By</th>
                <th>Reason</th>
                <th>Created At</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody>
            {% if reports %}
                {% for report in reports %}
                <tr>
                    <td>{{ forloop.counter }}</td>
                    <td>
                        <a href="{% url 'thread:thread_detail' report.thread.id %}" class="text-primary font-weight-bold">
                            {{ report.thread.thread_title }}
                        </a>
                    </td>
                    <td>{{ report.reported_by.username }}</td>
                    <td>{{ report.reason }}</td>
                    <td>{{ report.created_at|date:"Y-m-d H:i:s" }}</td>
                </tr>
                {% endfor %}
            {% else %}
                <tr>
                    <td colspan="6" class="text-center">No reports available.</td>
                </tr>
            {% endif %}
        </tbody>
    </table>

    <!-- Pagination and Back to Thread List Button -->
    <nav aria-label="Page navigation" class="mt-2">
        <ul class="pagination justify-content-center">
            {% if reports.has_previous %}
                <li class="page-item">
                    <a class="page-link" href="?page=1&q={{ query|urlencode }}" aria-label="First">
                        <span aria-hidden="true">&laquo; First</span>
                    </a>
                </li>
                <li class="page-item">
                    <a class="page-link" href="?page={{ reports.previous_page_number }}&q={{ query|urlencode }}" aria-label="Previous">
                        <span aria-hidden="true">&lsaquo; Previous</span>
                    </a>
                </li>
            {% endif %}

            {% for num in reports.paginator.page_range %}
                {% if num == reports.number %}
                    <li class="page-item active" aria-current="page">
                        <span class="page-link">{{ num }}</span>
                    </li>
                {% else %}
                    <li class="page-item">
                        <a class="page-link" href="?page={{ num }}&q={{ query|urlencode }}">{{ num }}</a>
                    </li>
                {% endif %}
            {% endfor %}

            {% if reports.has_next %}
                <li class="page-item">
                    <a class="page-link" href="?page={{ reports.next_page_number }}&q={{ query|urlencode }}" aria-label="Next">
                        <span aria-hidden="true">Next &rsaquo;</span>
                    </a>
                </li>
                <li class="page-item">
                    <a class="page-link" href="?page={{ reports.paginator.num_pages }}&q={{ query|urlencode }}" aria-label="Last">
                        <span aria-hidden="true">Last &raquo;</span>
                    </a>
                </li>
            {% endif %}
        </ul>
    </nav>

    <div class="text-center my-2">
        <a href="{% url 'thread:thread_list' %}" class="btn btn-secondary">Back to Thread List</a>
    </div>
</div>

{% endblock %}
